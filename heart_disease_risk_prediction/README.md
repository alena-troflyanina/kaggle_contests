# Предсказание вероятности сердечно-сосудистых заболеваний

## Цель проекта
Участие в соревновании по предсказанию вероятности риска сердечно-сосудистых заболеваний (ССЗ) на основе информации об образе жизни пациента.
Ключевой метрикой для соревнования является ROC AUC.

## Датасеты
Загружены csv-файлы с обучающей и тестовой выборками, а также файл my_submission.csv с предсказаниями обученной модели машинного обучения.

## Страница соревнования
https://www.kaggle.com/competitions/yap5-heart-diseases-prediction

## Используемые библиотеки
Для запуска проекта необходимо установить следующие библиотеки: 
- matplotlib
- numpy 
- pandas
- sklearn
- seaborn 
- xgboost

## Что было сделано
Тематика проекта требовала углубленного изучения предметной области и качественный исследовательский анализ данных.
Первое, с чем я столкнулась при получении общей информации об обучающем датасете - отсутствие пропущенных значений, но при этом данные были сильно "сырые" и требовали обработку аномальных значений и features engineering.
- я исследовала линейную корреляцию признаков, каждый числовой признак по отдельности, что позволило мне больше понять природу распределения данных, а также посчитала вероятности риска ССЗ для пациентов с различными показателями (ИМТ > 30, возраст > 53 лет, по наличию вредных привычек и т.д.);
- аномальные значения в числовых колонках веса, роста и артериального давления я заменила 1-м и 99-м процентилями;
- методом проб и ошибок искала наилучшие новые признаки для обучения, в итоге метрику качества удалось повысить за счет добавления следующих признаков: пульсовое давление, среднее артериальное давление, индекс массы тела, логарифм значения верхнего и нижнего давлений;
- подготовила признаки для обучения: разделила на выборки, отмасштабировала количественные признаки, закодировала категориальные признаки;
- вывела градацию признаков по значимости для моделей и сделала интересный вывод, что не всегда важный на первый взгляд признак является значимым для модели;
- подобрала наилучшие гиперпараметры с помощью GridSearchCV;
- я обучила 6 моделей и на кросс-валидации получила ключевую метрику ROC AUC;
- итоговое предсказание я сделала с помощью модели StackingClassifier() и для ее обучения использовала только те модели, значения метрики которых были больше 0.80;

## Выводы итогам соревнования
Мне удалось добиться значения метрики ROC AUC=0.80363 на обучающей выборке. После загрузки результатов на kaggle на тестовых данных Private Score был равен 0.80711. По результатам соревнования я заняла 4 место.
Для достижения наиболее точного предсказания я рекомендовала бы собирать больше данных о состоянии здоровья пациентов, а также более качественно контролировать их сбор, чтобы аномальных значений было меньше.

